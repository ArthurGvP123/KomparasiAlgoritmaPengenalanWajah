##### 0 - PERSIAPAN VIRTUAL ENVIRONMENT #####

py -3.10 -m venv .venv
.venv\Scripts\Activate.ps1
deactivate
python -m pip install --upgrade pip wheel setuptools
pip install -r requirements.txt

---

##### 1 - PERINTAH PROGRAM 01 UNTUK MEMOTONG DAN MERAPIKAN DATASET #####

python 01_merapikan_dataset.py --dataset-name Dosen --size 112 --sort on --probe-per-id 2
python 01_merapikan_dataset.py --dataset-name Dosen --size 160 --sort on --probe-per-id 2
python 01_merapikan_dataset.py --dataset-name Dosen --size 150 --sort on --probe-per-id 2

python 01_merapikan_dataset.py --dataset-name Dosen --size 112 --sort on --probe-per-id 0

python 01_merapikan_dataset.py --dataset-name Dosen --size 112 --sort off

Note:
a. default ukuran fungsi norm_crop adalah 112 dan 224, jika ingin diluar dari itu maka akan dipilih ukuran terdekat kemudian dilakukan resize
b. --sort on untuk mensortir foto dataset menjadi folder gallery dan probe
c. --sort off membuat program tidak melakukan sortir, melainkan hanya direktori murni dataset saja
d. --probe-per-id untuk menentukan banyaknya foto yang tersimpan dalam folder probe

---

##### 2 - PERINTAH PROGRAM 02 UNTUK EMBEDDING ALGORITMA #####

python 02_embed_adaface.py `
  --repo-name ".\algoritma\AdaFace" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\adaface_ir101_ms1mv2.ckpt" `
  --arch ir101 `
  --out ".\embeds\embeds_adaface_ir101.npz" `
  --batch 128

python 02_embed_curricularface.py `
  --repo-name ".\algoritma\CurricularFace" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\CurricularFace_Backbone.pth" `
  --arch irse101 `
  --out ".\embeds\embeds_curricularface_ir101.npz" `
  --batch 128

python 02_embed_cvlface.py `
  --dataset-name ".\dataset\Dosen_112" `
  --hf-id "minchul/cvlface_adaface_vit_base_kprpe_webface4m" `
  --out ".\embeds\embeds_cvlface_vitb_kprpe.npz" `
  --batch 128 `
  --device cpu

python 02_embed_dlib.py `
  --repo-name ".\algoritma\dlib" `
  --dataset-name ".\dataset\Dosen_150" `
  --weights-recog ".\algoritma\weights\dlib_face_recognition_resnet_model_v1.dat" `
  --weights-sp5   ".\algoritma\weights\shape_predictor_5_face_landmarks.dat" `
  --out ".\embeds\embeds_dlib.npz" `
  --chip-size 150

python 02_embed_elasticface.py `
  --repo-name ".\algoritma\ElasticFace" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\elasticface_ir100_backbone.pth" `
  --arch ir100 `
  --out ".\embeds\embeds_elasticface_ir100.npz" `
  --batch 128

python 02_embed_epl.py `
  --repo-name ".\algoritma\EPL" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\EPL_ResNet100_WebFace12M-002.pth" `
  --out ".\embeds\embeds_epl_ir100.npz" `
  --batch 128

python 02_embed_facenet.py `
  --repo-name ".\algoritma\FaceNet" `
  --dataset-name ".\dataset\Dosen_160" `
  --out ".\embeds\embeds_facenet.npz" `
  --batch 128 `
  --img-size 160 `
  --pretrained vggface2

python 02_embed_ghostfacenets.py `
  --repo-name ".\algoritma\GhostFaceNets" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\GhostFaceNet_W1.3_S2_ArcFace.h5" `
  --out ".\embeds\embeds_ghostfacenet_w1p3_s2.npz" `
  --batch 128

python 02_embed_lafs.py `
  --repo-name ".\algoritma\LAFS" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\LAFS_WebFace4M.pth" `
  --arch ir100 `
  --out ".\embeds\embeds_lafs_ir100.npz" `
  --batch 128

python 02_embed_lvface.py `
  --repo-name ".\algoritma\LVFace" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\LVFace-L_Glint360K.onnx" `
  --format onnx `
  --out ".\embeds\embeds_lvface_l.npz" `
  --batch 128

python 02_embed_magface.py `
  --repo-name ".\algoritma\MagFace" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\magface_ir100_ms1mv2.pth" `
  --arch ir100 `
  --out ".\embeds\embeds_magface_ir100.npz" `
  --batch 128

python .\02_embed_transface.py `
  --repo-name ".\algoritma\TransFace" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\ms1mv2_model_TransFace_L.pt" `
  --network transface_b `
  --out ".\embeds\embeds_transface_b.npz" `
  --batch 128

python 02_embed_transface.py `
  --repo-name ".\algoritma\TransFace" `
  --dataset-name ".\dataset\Dosen_112" `
  --weights ".\algoritma\weights\ms1mv2_model_TransFace_L.pt" `
  --network transface_l `
  --out ".\embeds\embeds_transface_vitl.npz" `
  --batch 128

Note: Sesuaikan argumen sesuai dengan output yang diinginkan

---

##### 3a - PERINTAH PROGRAM 03 COSINE UNTUK SEMUA ALGORITMA YANG TERSEDIA DALAM FOLDER EMBEDS #####

Get-ChildItem .\embeds\*.npz | ForEach-Object {
  python 03_evaluasi_performa_cosine.py --embeds $_.FullName --outdir eval_verif_cosine --fixed-thr 0.3
}

Get-ChildItem .\embeds\*.npz | ForEach-Object {
  python 03_evaluasi_performa_cosine.py --embeds $_.FullName --outdir eval_verif_cosine --fixed-thr 0.5
}

Get-ChildItem .\embeds\*.npz | ForEach-Object {
  python 03_evaluasi_performa_cosine.py --embeds $_.FullName --outdir eval_verif_cosine --fixed-thr 0.7
}

Note: Ubah nilai threshold yang ingin digunakan dalam pengujian

---

##### 3b - PERINTAH PROGRAM 03 COSINE UNTUK SALAH SATU ALGORITMA #####

python 03A_evaluasi_performa_cosine.py --embeds .\embeds\embeds_adaface_ir100.npz --outdir eval_verif_cosine --fixed-thr 0.3

Note: Ubah nama file embeds dan nilai threshold yang ingin digunakan dalam pengujian

---

##### 3c - PERINTAH PROGRAM 03 EUCLIDEAN UNTUK SEMUA ALGORITMA YANG TERSEDIA DALAM FOLDER EMBEDS #####

Get-ChildItem .\embeds\*.npz | ForEach-Object {
  python 03_evaluasi_performa_euclidean.py --embeds $_.FullName --outdir eval_verif_euclidean --fixed-thr 0.3
}

Get-ChildItem .\embeds\*.npz | ForEach-Object {
  python 03_evaluasi_performa_euclidean.py --embeds $_.FullName --outdir eval_verif_euclidean --fixed-thr 0.5
}

Get-ChildItem .\embeds\*.npz | ForEach-Object {
  python 03_evaluasi_performa_euclidean.py --embeds $_.FullName --outdir eval_verif_euclidean --fixed-thr 0.7
}

Note: Ubah nilai threshold yang ingin digunakan dalam pengujian

---

##### 3d - PERINTAH PROGRAM 03 EUCLIDEAN UNTUK SALAH SATU ALGORITMA #####

python 03_evaluasi_performa_euclidean.py --embeds .\embeds\embeds_adaface_ir100.npz --outdir eval_verif_cosine --fixed-thr 0.3

Note: Ubah nama file embeds dan nilai threshold yang ingin digunakan dalam pengujian

---

##### 4 - PERINTAH PROGRAM 04 UNTUK MENARIK KESIMPULAN ######

python 04_kesimpulan_evaluasi.py `
  --cosine-csv eval_verif_cosine/metrics_all_cosine.csv `
  --euclidean-csv eval_verif_euclidean/metrics_all_euclidean.csv `
  --out kesimpulan_evaluasi.csv

Note: Sesuaikan nama dan direktori file perhitungan metrik

---

##### TAMBAHAN #####

python test_read_npz.py
Note: untuk membaca isi embedding pada file npz